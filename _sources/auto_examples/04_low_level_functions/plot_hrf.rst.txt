

.. _sphx_glr_auto_examples_04_low_level_functions_plot_hrf.py:


Example of hemodynamic reponse functions.
=========================================
We consider the hrf model in SPM together with the hrf shape proposed by
G.Glover, as well as their time and dispersion derivatives.

Requires matplotlib

Author : Bertrand Thirion: 2009-2015



.. code-block:: python


    import numpy as np
    import matplotlib.pyplot as plt
    from nistats import hemodynamic_models








A first step: looking at our data
----------------------------------

Let's quickly plot this file:



.. code-block:: python

    frame_times = np.linspace(0, 30, 61)
    onset, amplitude, duration = 0., 1., 1.
    stim = np.zeros_like(frame_times)
    stim[(frame_times > onset) * (frame_times <= onset + duration)] = amplitude
    exp_condition = np.array((onset, duration, amplitude)).reshape(3, 1)
    hrf_models = [None, 'glover + derivative', 'glover + derivative + dispersion']







sample the hrf



.. code-block:: python

    fig = plt.figure(figsize=(9, 4))
    for i, hrf_model in enumerate(hrf_models):
        signal, name = hemodynamic_models.compute_regressor(
            exp_condition, hrf_model, frame_times, con_id='main',
            oversampling=16)

        plt.subplot(1, 3, i + 1)
        plt.fill(frame_times, stim, 'k', alpha=.5, label='stimulus')
        for j in range(signal.shape[1]):
            plt.plot(frame_times, signal.T[j], label=name[j])
        plt.xlabel('time (s)')
        plt.legend(loc=1)
        plt.title(hrf_model)

    plt.subplots_adjust(bottom=.12)
    plt.show()



.. image:: /auto_examples/04_low_level_functions/images/sphx_glr_plot_hrf_001.png
    :align: center




**Total running time of the script:** ( 0 minutes  0.230 seconds)



.. container:: sphx-glr-footer


  .. container:: sphx-glr-download

     :download:`Download Python source code: plot_hrf.py <plot_hrf.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: plot_hrf.ipynb <plot_hrf.ipynb>`

.. rst-class:: sphx-glr-signature

    `Generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
