
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Nistats: Functional MRI in Python &#8212; functional MRI for NeuroImaging</title>
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.2.2. Default Mode Network extraction of AHDH dataset" href="plot_adhd_dmn.html" />
    <link rel="prev" title="2.1.2. Studying first-level-model details in a trials-and-error fashion" href="../01_tutorials/plot_first_level_model_details.html" />
<meta content="True" name="HandheldFriendly">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<meta name="keywords" content="nistats, neuroimaging, python, neuroscience, statistics">
<script type="text/javascript">
$(function () {
    // Lock the table of content to a fixed position once we scroll enough
    var top = 105 + $('.sphinxsidebarwrapper').offset().top - parseFloat($('.sphinxsidebarwrapper').css('margin-top').replace(/auto/, 0)),
        sections = {},
        i        = 0,
	url	 = document.URL.replace(/#.*$/, ""),
	current_section = 0;

    // Grab positions of our sections
    $('.headerlink').each(function(){
        sections[this.href.replace(url, '')] = $(this).offset().top - 50;
    });

    $(window).scroll(function(event) {
	var pos   = $(window).scrollTop();
	// Lock the table of content to a fixed position once we scroll enough
	if(pos > top){
	    //begin to scroll
	    $('.sphinxsidebarwrapper').css("position", "fixed");
	    $('.sphinxsidebarwrapper').css("top", -105);
	}
	else{
	    //lock it back into place
	    $('.sphinxsidebarwrapper').css("position", "relative");
	    $('.sphinxsidebarwrapper').css("top",0);
	}

	// Highlight the current section
	$('a.internal').removeClass('active');
        for(i in sections){
            if(sections[i] > pos){
		break;
            };
	    if($('a.internal[href$="' + i + '"]').is(':visible')){
		current_section = i;
	    };
        }
	$('a.internal[href$="' + current_section + '"]').addClass('active');
    });

});
</script>


<script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-41920728-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

  </head><body>
<div id="logo-banner">
  <div class="logo">
    <a href="../../index.html">
      <img src="../../_static/nistats-logo.png" alt="Nistats logo"  border="0" />
    </a>
  </div>
  <!-- A tag cloud to make it easy for people to find what they are
                         looking for -->
 <div class="tags">
  <ul>
    <li>
      <big><a href="../04_low_level_functions/plot_hrf.html">HRF</a></big>
    </li>
    <li>
      <small><a href="../04_low_level_functions/plot_design_matrix.html">Design Matrix</a></small>
    </li>
    <li>
      <small><a href="plot_localizer_analysis.html">First Level</a></small>
    </li>
    <li>
      <big><a href="../03_second_level_models/plot_thresholding.html">Second Level</a></big>
    </li>
    <li>
      <big><a href="../01_tutorials/plot_bids_analysis.html">BIDS datasets</a></big>
    </li>
  </ul>
 </div>

  <div class="banner">
    <h1>Nistats:</h1>
    <h2>Functional MRI Neuro-Imaging in Python</h2>
  </div>
  <div class="search_form">
    <div id="cse" style="width: 100%;"></div>
    <script src="http://www.google.com/jsapi" type="text/javascript"></script>
    <script type="text/javascript">
      google.load('search', '1', {language : 'en'});
      google.setOnLoadCallback(function() {
      var customSearchControl = new google.search.CustomSearchControl('014136483057745874622:r-npolb1uki');
      customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
      var options = new google.search.DrawOptions();
      options.setAutoComplete(true);
      customSearchControl.draw('cse', options);
      }, true);
    </script>
  </div>
</div>



    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="plot_adhd_dmn.html" title="2.2.2. Default Mode Network extraction of AHDH dataset"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../01_tutorials/plot_first_level_model_details.html" title="2.1.2. Studying first-level-model details in a trials-and-error fashion"
             accesskey="P">previous</a> |</li>
<li><a href="../../index.html">Nistats Home</a> |&nbsp;</li>
<li><a href="../../user_guide.html">User Guide</a> |&nbsp;</li>
<li><a href="../index.html">Examples</a> |&nbsp;</li>
<li><a href="../../modules/reference.html">Reference</a> |&nbsp;</li>
<li id="navbar-about"><a href="../../authors.html">About</a>|&nbsp;</li>
<li id="navbar-ecosystem"><a href="http://www.nipy.org/">Nipy ecosystem</a></li>

          <li class="nav-item nav-item-1"><a href="../../user_guide.html" >User guide: table of contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" accesskey="U"><span class="section-number">2. </span>Nistats usage examples</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">


<h4> Giving credit </h4>
  <ul class="simple">
    <li><p>Please consider <a href="../../authors.html#citing">citing the
                    papers</a>.</p></li>
  </ul>

  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">2.2.1. Example of explicit fixed effects fMRI model fitting</a><ul>
<li><a class="reference internal" href="#prepare-data-and-analysis-parameters">2.2.1.1. Prepare data and analysis parameters</a></li>
<li><a class="reference internal" href="#glm-estimation">2.2.1.2. GLM estimation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../01_tutorials/plot_first_level_model_details.html"
                        title="previous chapter"><span class="section-number">2.1.2. </span>Studying first-level-model details in a trials-and-error fashion</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="plot_adhd_dmn.html"
                        title="next chapter"><span class="section-number">2.2.2. </span>Default Mode Network extraction of AHDH dataset</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-02-first-level-models-plot-fixed-effects-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="example-of-explicit-fixed-effects-fmri-model-fitting">
<span id="sphx-glr-auto-examples-02-first-level-models-plot-fixed-effects-py"></span><h1><span class="section-number">2.2.1. </span>Example of explicit fixed effects fMRI model fitting<a class="headerlink" href="#example-of-explicit-fixed-effects-fmri-model-fitting" title="Permalink to this headline">¶</a></h1>
<p>This example illustrates how to run a fixed effects model based on
pre-computed statistics. This is helpful when the initial models
have to be fit separately.</p>
<p>For details on the data, please see:</p>
<p>Dehaene-Lambertz G, Dehaene S, Anton JL, Campagne A, Ciuciu P, Dehaene
G, Denghien I, Jobert A, LeBihan D, Sigman M, Pallier C, Poline
JB. Functional segregation of cortical language areas by sentence
repetition. Hum Brain Mapp. 2006: 27:360–371.
<a class="reference external" href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2653076#R11">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2653076#R11</a></p>
<p>Please see <a class="reference external" href="https://nistats.github.io/auto_examples/02_first_level_models/plot_fiac_analysis.html">Simple example of two-session fMRI model fitting</a>
example for details.  The main difference is that
the fixed-effects model is run explicitly here,
after GLM fitting on two sessions.</p>
<div class="section" id="prepare-data-and-analysis-parameters">
<h2><span class="section-number">2.2.1.1. </span>Prepare data and analysis parameters<a class="headerlink" href="#prepare-data-and-analysis-parameters" title="Permalink to this headline">¶</a></h2>
<p>Inspecting ‘data’, we note that there are two sessions</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nistats</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="n">data</span> <span class="o">=</span> <a href="../../modules/generated/nistats.datasets.fetch_fiac_first_level.html#nistats.datasets.fetch_fiac_first_level" title="View documentation for nistats.datasets.fetch_fiac_first_level"><span class="n">datasets</span><span class="o">.</span><span class="n">fetch_fiac_first_level</span></a><span class="p">()</span>
<span class="n">fmri_img</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;func1&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;func2&#39;</span><span class="p">]]</span>
</pre></div>
</div>
<p>Create a mean image for plotting purpose</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <a href="http://nilearn.github.io/modules/generated/nilearn.image.mean_img.html#nilearn.image.mean_img" title="View documentation for nilearn.image.mean_img"><span class="n">mean_img</span></a>
<span class="n">mean_img_</span> <span class="o">=</span> <a href="http://nilearn.github.io/modules/generated/nilearn.image.mean_img.html#nilearn.image.mean_img" title="View documentation for nilearn.image.mean_img"><span class="n">mean_img</span></a><span class="p">(</span><span class="n">fmri_img</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>The design matrices were pre-computed, we simply put them in a list of DataFrames</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">design_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;design_matrix1&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;design_matrix2&#39;</span><span class="p">]]</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">design_matrices</span> <span class="o">=</span> <span class="p">[</span><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="View documentation for pandas.DataFrame"><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span></a><span class="p">(</span><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.load.html#numpy.load" title="View documentation for numpy.load"><span class="n">np</span><span class="o">.</span><span class="n">load</span></a><span class="p">(</span><span class="n">df</span><span class="p">)[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">design_files</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="glm-estimation">
<h2><span class="section-number">2.2.1.2. </span>GLM estimation<a class="headerlink" href="#glm-estimation" title="Permalink to this headline">¶</a></h2>
<p>GLM specification. Note that the mask was provided in the dataset. So we use it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nistats.first_level_model</span> <span class="kn">import</span> <a href="../../modules/generated/nistats.first_level_model.FirstLevelModel.html#nistats.first_level_model.FirstLevelModel" title="View documentation for nistats.first_level_model.FirstLevelModel"><span class="n">FirstLevelModel</span></a>
<a href="../../modules/generated/nistats.first_level_model.FirstLevelModel.html#nistats.first_level_model.FirstLevelModel" title="View documentation for nistats.first_level_model.FirstLevelModel"><span class="n">fmri_glm</span></a> <span class="o">=</span> <a href="../../modules/generated/nistats.first_level_model.FirstLevelModel.html#nistats.first_level_model.FirstLevelModel" title="View documentation for nistats.first_level_model.FirstLevelModel"><span class="n">FirstLevelModel</span></a><span class="p">(</span><span class="n">mask_img</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;mask&#39;</span><span class="p">],</span> <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                           <span class="n">minimize_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Compute fixed effects of the two runs and compute related images
For this, we first define the contrasts as we would do for a single session</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/2.7/library/functions.html#int" title="View documentation for builtins.int"><span class="n">n_columns</span></a> <span class="o">=</span> <span class="n">design_matrices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">contrast_val</span></a> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.hstack.html#numpy.hstack" title="View documentation for numpy.hstack"><span class="n">np</span><span class="o">.</span><span class="n">hstack</span></a><span class="p">(([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.zeros.html#numpy.zeros" title="View documentation for numpy.zeros"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><a href="https://docs.python.org/2.7/library/functions.html#int" title="View documentation for builtins.int"><span class="n">n_columns</span></a> <span class="o">-</span> <span class="mi">4</span><span class="p">)))</span>
</pre></div>
</div>
<p>Statistics for the first session</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="n">cut_coords</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">129</span><span class="p">,</span> <span class="o">-</span><span class="mi">126</span><span class="p">,</span> <span class="mi">49</span><span class="p">]</span>
<a href="https://docs.python.org/2.7/library/functions.html#str" title="View documentation for builtins.str"><span class="n">contrast_id</span></a> <span class="o">=</span> <span class="s1">&#39;DSt_minus_SSt&#39;</span>

<a href="../../modules/generated/nistats.first_level_model.FirstLevelModel.html#nistats.first_level_model.FirstLevelModel" title="View documentation for nistats.first_level_model.FirstLevelModel"><span class="n">fmri_glm</span></a> <span class="o">=</span> <a href="../../modules/generated/nistats.first_level_model.FirstLevelModel.html#nistats.first_level_model.FirstLevelModel" title="View documentation for nistats.first_level_model.FirstLevelModel"><span class="n">fmri_glm</span></a><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fmri_img</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">design_matrices</span><span class="o">=</span><span class="n">design_matrices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">summary_statistics_session1</span></a> <span class="o">=</span> <a href="../../modules/generated/nistats.first_level_model.FirstLevelModel.html#nistats.first_level_model.FirstLevelModel" title="View documentation for nistats.first_level_model.FirstLevelModel"><span class="n">fmri_glm</span></a><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span>
    <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">contrast_val</span></a><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<a href="http://nilearn.github.io/modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map" title="View documentation for nilearn.plotting.plot_stat_map"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span></a><span class="p">(</span>
    <a href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">summary_statistics_session1</span></a><span class="p">[</span><span class="s1">&#39;z_score&#39;</span><span class="p">],</span>
    <span class="n">bg_img</span><span class="o">=</span><span class="n">mean_img_</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">cut_coords</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">, first session&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/2.7/library/functions.html#str" title="View documentation for builtins.str"><span class="n">contrast_id</span></a><span class="p">))</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_fixed_effects_001.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_fixed_effects_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;nilearn.plotting.displays.OrthoSlicer object at 0x7f6f143d64a8&gt;
</pre></div>
</div>
<p>Statistics for the second session</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../modules/generated/nistats.first_level_model.FirstLevelModel.html#nistats.first_level_model.FirstLevelModel" title="View documentation for nistats.first_level_model.FirstLevelModel"><span class="n">fmri_glm</span></a> <span class="o">=</span> <a href="../../modules/generated/nistats.first_level_model.FirstLevelModel.html#nistats.first_level_model.FirstLevelModel" title="View documentation for nistats.first_level_model.FirstLevelModel"><span class="n">fmri_glm</span></a><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fmri_img</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">design_matrices</span><span class="o">=</span><span class="n">design_matrices</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">summary_statistics_session2</span></a> <span class="o">=</span> <a href="../../modules/generated/nistats.first_level_model.FirstLevelModel.html#nistats.first_level_model.FirstLevelModel" title="View documentation for nistats.first_level_model.FirstLevelModel"><span class="n">fmri_glm</span></a><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span>
    <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">contrast_val</span></a><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<a href="http://nilearn.github.io/modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map" title="View documentation for nilearn.plotting.plot_stat_map"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span></a><span class="p">(</span>
    <a href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">summary_statistics_session2</span></a><span class="p">[</span><span class="s1">&#39;z_score&#39;</span><span class="p">],</span>
    <span class="n">bg_img</span><span class="o">=</span><span class="n">mean_img_</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">cut_coords</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">, second session&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/2.7/library/functions.html#str" title="View documentation for builtins.str"><span class="n">contrast_id</span></a><span class="p">))</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_fixed_effects_002.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_fixed_effects_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;nilearn.plotting.displays.OrthoSlicer object at 0x7f6f13d9b048&gt;
</pre></div>
</div>
<p>Fixed effects statistics</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nistats.contrasts</span> <span class="kn">import</span> <span class="n">compute_fixed_effects</span>

<span class="n">contrast_imgs</span> <span class="o">=</span> <span class="p">[</span><a href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">summary_statistics_session1</span></a><span class="p">[</span><span class="s1">&#39;effect_size&#39;</span><span class="p">],</span>
                 <a href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">summary_statistics_session2</span></a><span class="p">[</span><span class="s1">&#39;effect_size&#39;</span><span class="p">]]</span>
<span class="n">variance_imgs</span> <span class="o">=</span> <span class="p">[</span><a href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">summary_statistics_session1</span></a><span class="p">[</span><span class="s1">&#39;effect_variance&#39;</span><span class="p">],</span>
                 <a href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="View documentation for builtins.dict"><span class="n">summary_statistics_session2</span></a><span class="p">[</span><span class="s1">&#39;effect_variance&#39;</span><span class="p">]]</span>

<span class="n">fixed_fx_contrast</span><span class="p">,</span> <span class="n">fixed_fx_variance</span><span class="p">,</span> <span class="n">fixed_fx_stat</span> <span class="o">=</span> <span class="n">compute_fixed_effects</span><span class="p">(</span>
    <span class="n">contrast_imgs</span><span class="p">,</span> <span class="n">variance_imgs</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;mask&#39;</span><span class="p">])</span>
<a href="http://nilearn.github.io/modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map" title="View documentation for nilearn.plotting.plot_stat_map"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span></a><span class="p">(</span>
    <span class="n">fixed_fx_stat</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">mean_img_</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">cut_coords</span><span class="o">=</span><span class="n">cut_coords</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">, fixed effects&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/2.7/library/functions.html#str" title="View documentation for builtins.str"><span class="n">contrast_id</span></a><span class="p">))</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_fixed_effects_003.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_fixed_effects_003.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;nilearn.plotting.displays.OrthoSlicer object at 0x7f6ec42f50f0&gt;
</pre></div>
</div>
<p>Not unexpectedly, the fixed effects version displays higher peaks than the input sessions. Computing fixed effects enhances the signal-to-noise ratio of the resulting brain maps
Note however that, technically, the output maps of the fixed effects map is a t statistic (not a z statistic)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="http://nilearn.github.io/modules/generated/nilearn.plotting.show.html#nilearn.plotting.show" title="View documentation for nilearn.plotting.show"><span class="n">plotting</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  5.245 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-02-first-level-models-plot-fixed-effects-py">
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c57443a288b73bf404b52a713abc6032/plot_fixed_effects.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_fixed_effects.py</span></code></a></p>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/34ea8fc4bf4841eb58cb42a59eed79a8/plot_fixed_effects.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_fixed_effects.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="plot_adhd_dmn.html" title="2.2.2. Default Mode Network extraction of AHDH dataset"
             >next</a> |</li>
        <li class="right" >
          <a href="../01_tutorials/plot_first_level_model_details.html" title="2.1.2. Studying first-level-model details in a trials-and-error fashion"
             >previous</a> |</li>
<li><a href="../../index.html">Nistats Home</a> |&nbsp;</li>
<li><a href="../../user_guide.html">User Guide</a> |&nbsp;</li>
<li><a href="../index.html">Examples</a> |&nbsp;</li>
<li><a href="../../modules/reference.html">Reference</a> |&nbsp;</li>
<li id="navbar-about"><a href="../../authors.html">About</a>|&nbsp;</li>
<li id="navbar-ecosystem"><a href="http://www.nipy.org/">Nipy ecosystem</a></li>

          <li class="nav-item nav-item-1"><a href="../../user_guide.html" >User guide: table of contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" ><span class="section-number">2. </span>Nistats usage examples</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer">
            &copy; The nistats developers 2010-2016.
          Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.4.4.
        <span style="padding-left: 5ex;">
          <a href="../../_sources/auto_examples/02_first_level_models/plot_fixed_effects.rst.txt"
        	 rel="nofollow">Show this page source</a>
        </span>
    </div>
  </body>
</html>