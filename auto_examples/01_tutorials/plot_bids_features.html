
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Nistats: Functional MRI in Python &#8212; functional MRI for NeuroImaging</title>
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3.1.3. Univariate analysis of block design, one condition versus rest, single subject" href="plot_spm_auditory.html" />
    <link rel="prev" title="3.1.1. BIDS dataset first and second level analysis" href="plot_bids_analysis.html" />
<meta content="True" name="HandheldFriendly">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<meta name="keywords" content="nistats, neuroimaging, python, neuroscience, statistics">
<script type="text/javascript">
$(function () {
    // Lock the table of content to a fixed position once we scroll enough
    var top = 105 + $('.sphinxsidebarwrapper').offset().top - parseFloat($('.sphinxsidebarwrapper').css('margin-top').replace(/auto/, 0)),
        sections = {},
        i        = 0,
	url	 = document.URL.replace(/#.*$/, ""),
	current_section = 0;

    // Grab positions of our sections
    $('.headerlink').each(function(){
        sections[this.href.replace(url, '')] = $(this).offset().top - 50;
    });

    $(window).scroll(function(event) {
	var pos   = $(window).scrollTop();
	// Lock the table of content to a fixed position once we scroll enough
	if(pos > top){
	    //begin to scroll
	    $('.sphinxsidebarwrapper').css("position", "fixed");
	    $('.sphinxsidebarwrapper').css("top", -105);
	}
	else{
	    //lock it back into place
	    $('.sphinxsidebarwrapper').css("position", "relative");
	    $('.sphinxsidebarwrapper').css("top",0);
	}

	// Highlight the current section
	$('a.internal').removeClass('active');
        for(i in sections){
            if(sections[i] > pos){
		break;
            };
	    if($('a.internal[href$="' + i + '"]').is(':visible')){
		current_section = i;
	    };
        }
	$('a.internal[href$="' + current_section + '"]').addClass('active');
    });

});
</script>


<script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-41920728-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

  </head><body>
<div id="logo-banner">
  <div class="logo">
    <a href="../../index.html">
      <img src="../../_static/nistats-logo.png" alt="Nistats logo"  border="0" />
    </a>
  </div>
  <!-- A tag cloud to make it easy for people to find what they are
                         looking for -->
 <div class="tags">
  <ul>
    <li>
      <big><a href="../04_low_level_functions/plot_hrf.html">HRF</a></big>
    </li>
    <li>
      <small><a href="../04_low_level_functions/plot_design_matrix.html">Design Matrix</a></small>
    </li>
    <li>
      <small><a href="../02_first_level_models/plot_localizer_analysis.html">First Level</a></small>
    </li>
    <li>
      <big><a href="../03_second_level_models/plot_second_level_button_press.html">Second Level</a></big>
    </li>
    <li>
      <big><a href="plot_bids_analysis.html">BIDS datasets</a></big>
    </li>
  </ul>
 </div>

  <div class="banner">
    <h1>Nistats:</h1>
    <h2>Functional MRI Neuro-Imaging in Python</h2>
  </div>
  <div class="search_form">
    <div id="cse" style="width: 100%;"></div>
    <script src="http://www.google.com/jsapi" type="text/javascript"></script>
    <script type="text/javascript">
      google.load('search', '1', {language : 'en'});
      google.setOnLoadCallback(function() {
      var customSearchControl = new google.search.CustomSearchControl('014136483057745874622:r-npolb1uki');
      customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
      var options = new google.search.DrawOptions();
      options.setAutoComplete(true);
      customSearchControl.draw('cse', options);
      }, true);
    </script>
  </div>
</div>



    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="plot_spm_auditory.html" title="3.1.3. Univariate analysis of block design, one condition versus rest, single subject"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_bids_analysis.html" title="3.1.1. BIDS dataset first and second level analysis"
             accesskey="P">previous</a> |</li>
<li><a href="../../index.html">Nistats Home</a> |&nbsp;</li>
<li><a href="../../user_guide.html">User Guide</a> |&nbsp;</li>
<li><a href="../index.html">Examples</a> |&nbsp;</li>
<li><a href="../../modules/reference.html">Reference</a> |&nbsp;</li>
<li id="navbar-about"><a href="../../authors.html">About</a>|&nbsp;</li>
<li id="navbar-ecosystem"><a href="http://www.nipy.org/">Nipy ecosystem</a></li>

          <li class="nav-item nav-item-1"><a href="../../user_guide.html" >User guide: table of contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" accesskey="U">3. Nistats usage examples</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">


<h4> Giving credit </h4>
  <ul class="simple">
    <li><p>Please consider <a href="../../authors.html#citing">citing the
                    papers</a>.</p></li>
  </ul>

  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3.1.2. First level analysis of a complete BIDS dataset from openneuro</a><ul>
<li><a class="reference internal" href="#fetch-openneuro-bids-dataset">3.1.2.1. Fetch openneuro BIDS dataset</a></li>
<li><a class="reference internal" href="#obtain-automatically-firstlevelmodel-objects-and-fit-arguments">3.1.2.2. Obtain automatically FirstLevelModel objects and fit arguments</a></li>
<li><a class="reference internal" href="#first-level-model-estimation-one-subject">3.1.2.3. First level model estimation (one subject)</a></li>
<li><a class="reference internal" href="#simple-statistical-report-of-thresholded-contrast">3.1.2.4. Simple statistical report of thresholded contrast</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="plot_bids_analysis.html"
                        title="previous chapter">3.1.1. BIDS dataset first and second level analysis</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="plot_spm_auditory.html"
                        title="next chapter">3.1.3. Univariate analysis of block design, one condition versus rest, single subject</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="first-level-analysis-of-a-complete-bids-dataset-from-openneuro">
<span id="sphx-glr-auto-examples-01-tutorials-plot-bids-features-py"></span><h1>3.1.2. First level analysis of a complete BIDS dataset from openneuro<a class="headerlink" href="#first-level-analysis-of-a-complete-bids-dataset-from-openneuro" title="Permalink to this headline">¶</a></h1>
<p>Full step-by-step example of fitting a GLM to perform a first level analysis
in an openneuro BIDS dataset. We demonstrate how BIDS derivatives can be
exploited to perform a simple one subject analysis with minimal code.
Details about the BIDS standard are available at <a class="reference external" href="http://bids.neuroimaging.io/">http://bids.neuroimaging.io/</a>
We also demonstrate how to download individual groups of files from the
Openneuro s3 bucket.</p>
<p>More specifically:</p>
<ol class="arabic simple">
<li>Download an fMRI BIDS dataset with derivatives from openneuro</li>
<li>Extract automatically from the BIDS dataset first level model objects</li>
<li>Demonstrate Quality assurance of Nistat estimation against available FSL
estimation in the openneuro dataset</li>
<li>Display contrast plot and uncorrected first level statistics table report</li>
</ol>
<p>To run this example, you must launch IPython via <code class="docutils literal notranslate"><span class="pre">ipython</span>
<span class="pre">--matplotlib</span></code> in a terminal, or use the Jupyter notebook.</p>
<div class="contents local topic" id="contents">
<p class="topic-title first"><strong>Contents</strong></p>
<ul class="simple">
<li><a class="reference internal" href="#fetch-openneuro-bids-dataset" id="id1">Fetch openneuro BIDS dataset</a></li>
<li><a class="reference internal" href="#obtain-automatically-firstlevelmodel-objects-and-fit-arguments" id="id2">Obtain automatically FirstLevelModel objects and fit arguments</a></li>
<li><a class="reference internal" href="#first-level-model-estimation-one-subject" id="id3">First level model estimation (one subject)</a></li>
<li><a class="reference internal" href="#simple-statistical-report-of-thresholded-contrast" id="id4">Simple statistical report of thresholded contrast</a></li>
</ul>
</div>
<div class="section" id="fetch-openneuro-bids-dataset">
<h2><a class="toc-backref" href="#id1">3.1.2.1. Fetch openneuro BIDS dataset</a><a class="headerlink" href="#fetch-openneuro-bids-dataset" title="Permalink to this headline">¶</a></h2>
<p>We download one subject from the stopsignal task in the ds000030 V4 BIDS
dataset available in openneuro.
This dataset contains the necessary information to run a statistical analysis
using Nistats. The dataset also contains statistical results from a previous
FSL analysis that we can employ for comparison with the Nistats estimation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nistats.datasets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">fetch_openneuro_dataset_index</span><span class="p">,</span>
                              <span class="n">fetch_openneuro_dataset</span><span class="p">,</span> <span class="n">select_from_index</span><span class="p">)</span>

<span class="n">_</span><span class="p">,</span> <span class="n">urls</span> <span class="o">=</span> <span class="n">fetch_openneuro_dataset_index</span><span class="p">()</span>

<span class="n">exclusion_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;*group*&#39;</span><span class="p">,</span> <span class="s1">&#39;*phenotype*&#39;</span><span class="p">,</span> <span class="s1">&#39;*mriqc*&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;*parameter_plots*&#39;</span><span class="p">,</span> <span class="s1">&#39;*physio_plots*&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;*space-fsaverage*&#39;</span><span class="p">,</span> <span class="s1">&#39;*space-T1w*&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;*dwi*&#39;</span><span class="p">,</span> <span class="s1">&#39;*beh*&#39;</span><span class="p">,</span> <span class="s1">&#39;*task-bart*&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;*task-rest*&#39;</span><span class="p">,</span> <span class="s1">&#39;*task-scap*&#39;</span><span class="p">,</span> <span class="s1">&#39;*task-task*&#39;</span><span class="p">]</span>
<span class="n">urls</span> <span class="o">=</span> <span class="n">select_from_index</span><span class="p">(</span>
    <span class="n">urls</span><span class="p">,</span> <span class="n">exclusion_filters</span><span class="o">=</span><span class="n">exclusion_patterns</span><span class="p">,</span> <span class="n">n_subjects</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">data_dir</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">fetch_openneuro_dataset</span><span class="p">(</span><span class="n">urls</span><span class="o">=</span><span class="n">urls</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="obtain-automatically-firstlevelmodel-objects-and-fit-arguments">
<h2><a class="toc-backref" href="#id2">3.1.2.2. Obtain automatically FirstLevelModel objects and fit arguments</a><a class="headerlink" href="#obtain-automatically-firstlevelmodel-objects-and-fit-arguments" title="Permalink to this headline">¶</a></h2>
<p>From the dataset directory we obtain automatically FirstLevelModel objects
with their subject_id filled from the BIDS dataset. Moreover we obtain
for each model the list of run imgs and their respective events and
confounder regressors. Confounders are inferred from the confounds.tsv files
available in the BIDS dataset.
To get the first level models we have to specify the dataset directory,
the task_label and the space_label as specified in the file names.
We also have to provide the folder with the desired derivatives, that in this
case were produced by the fmriprep BIDS app.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nistats.first_level_model</span> <span class="kn">import</span> <span class="n">first_level_models_from_bids</span>
<span class="n">task_label</span> <span class="o">=</span> <span class="s1">&#39;stopsignal&#39;</span>
<span class="n">space_label</span> <span class="o">=</span> <span class="s1">&#39;MNI152NLin2009cAsym&#39;</span>
<span class="n">derivatives_folder</span> <span class="o">=</span> <span class="s1">&#39;derivatives/fmriprep&#39;</span>
<span class="n">models</span><span class="p">,</span> <span class="n">models_run_imgs</span><span class="p">,</span> <span class="n">models_events</span><span class="p">,</span> <span class="n">models_confounds</span> <span class="o">=</span> \
    <span class="n">first_level_models_from_bids</span><span class="p">(</span>
        <span class="n">data_dir</span><span class="p">,</span> <span class="n">task_label</span><span class="p">,</span> <span class="n">space_label</span><span class="p">,</span> <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
        <span class="n">derivatives_folder</span><span class="o">=</span><span class="n">derivatives_folder</span><span class="p">)</span>
</pre></div>
</div>
<p>Take model and model arguments of the subject and process events</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="p">,</span> <span class="n">imgs</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">confounds</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">models_run_imgs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">models_events</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">models_confounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">subject</span> <span class="o">=</span> <span class="s1">&#39;sub-&#39;</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">subject_label</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">nistats.utils</span> <span class="kn">import</span> <span class="n">get_design_from_fslmat</span>
<span class="n">fsl_design_matrix_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;derivatives&#39;</span><span class="p">,</span> <span class="s1">&#39;task&#39;</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="s1">&#39;stopsignal.feat&#39;</span><span class="p">,</span> <span class="s1">&#39;design.mat&#39;</span><span class="p">)</span>
<span class="n">design_matrix</span> <span class="o">=</span> <span class="n">get_design_from_fslmat</span><span class="p">(</span>
    <span class="n">fsl_design_matrix_path</span><span class="p">,</span> <span class="n">column_names</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<p>We identify the columns of the Go and StopSuccess conditions of the
design matrix inferred from the fsl file, to use them later for contrast
definition.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">design_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cond_</span><span class="si">%02d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">design_matrix</span><span class="o">.</span><span class="n">columns</span><span class="p">))]</span>
<span class="n">design_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Go&#39;</span>
<span class="n">design_columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;StopSuccess&#39;</span>
<span class="n">design_matrix</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">design_columns</span>
</pre></div>
</div>
</div>
<div class="section" id="first-level-model-estimation-one-subject">
<h2><a class="toc-backref" href="#id3">3.1.2.3. First level model estimation (one subject)</a><a class="headerlink" href="#first-level-model-estimation-one-subject" title="Permalink to this headline">¶</a></h2>
<p>We fit the first level model for one subject.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">imgs</span><span class="p">,</span> <span class="n">design_matrices</span><span class="o">=</span><span class="p">[</span><span class="n">design_matrix</span><span class="p">])</span>
</pre></div>
</div>
<p>Then we compute the StopSuccess - Go contrast. We can use the column names
of the design matrix.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">z_map</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="s1">&#39;StopSuccess - Go&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We show agreement between the Nistats estimation and the FSL estimation
available in the dataset</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nibabel</span> <span class="kn">as</span> <span class="nn">nib</span>
<span class="n">fsl_z_map</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;derivatives&#39;</span><span class="p">,</span> <span class="s1">&#39;task&#39;</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="s1">&#39;stopsignal.feat&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;stats&#39;</span><span class="p">,</span> <span class="s1">&#39;zstat12.nii.gz&#39;</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<a href="http://nilearn.github.io/modules/generated/nilearn.plotting.plot_glass_brain.html#nilearn.plotting.plot_glass_brain" title="View documentation for nilearn.plotting.plot_glass_brain"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_glass_brain</span></a><span class="p">(</span><span class="n">z_map</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="mf">0.001</span><span class="p">),</span>
                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Nistats Z map of &quot;StopSuccess - Go&quot; (unc p&lt;0.001)&#39;</span><span class="p">,</span>
                          <span class="n">plot_abs</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">)</span>
<a href="http://nilearn.github.io/modules/generated/nilearn.plotting.plot_glass_brain.html#nilearn.plotting.plot_glass_brain" title="View documentation for nilearn.plotting.plot_glass_brain"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_glass_brain</span></a><span class="p">(</span><span class="n">fsl_z_map</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="mf">0.001</span><span class="p">),</span>
                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;FSL Z map of &quot;StopSuccess - Go&quot; (unc p&lt;0.001)&#39;</span><span class="p">,</span>
                          <span class="n">plot_abs</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="View documentation for matplotlib.pyplot.show"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>

<span class="kn">from</span> <span class="nn">nistats.reporting</span> <span class="kn">import</span> <span class="n">compare_niimgs</span>
<span class="n">compare_niimgs</span><span class="p">([</span><span class="n">z_map</span><span class="p">],</span> <span class="p">[</span><span class="n">fsl_z_map</span><span class="p">],</span> <span class="n">model</span><span class="o">.</span><span class="n">masker_</span><span class="p">,</span>
               <span class="n">ref_label</span><span class="o">=</span><span class="s1">&#39;Nistats&#39;</span><span class="p">,</span> <span class="n">src_label</span><span class="o">=</span><span class="s1">&#39;FSL&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="View documentation for matplotlib.pyplot.show"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><a class="first reference internal image-reference" href="../../_images/sphx_glr_plot_bids_features_001.png"><img alt="../../_images/sphx_glr_plot_bids_features_001.png" src="../../_images/sphx_glr_plot_bids_features_001.png" style="width: 343.09999999999997px; height: 122.19999999999999px;" /></a>
</li>
<li><a class="first reference internal image-reference" href="../../_images/sphx_glr_plot_bids_features_002.png"><img alt="../../_images/sphx_glr_plot_bids_features_002.png" src="../../_images/sphx_glr_plot_bids_features_002.png" style="width: 343.09999999999997px; height: 122.19999999999999px;" /></a>
</li>
<li><a class="first reference internal image-reference" href="../../_images/sphx_glr_plot_bids_features_003.png"><img alt="../../_images/sphx_glr_plot_bids_features_003.png" src="../../_images/sphx_glr_plot_bids_features_003.png" style="width: 564.0px; height: 235.0px;" /></a>
</li>
</ul>
</div>
<div class="section" id="simple-statistical-report-of-thresholded-contrast">
<h2><a class="toc-backref" href="#id4">3.1.2.4. Simple statistical report of thresholded contrast</a><a class="headerlink" href="#simple-statistical-report-of-thresholded-contrast" title="Permalink to this headline">¶</a></h2>
<p>We display the contrast plot and table with cluster information</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nistats.reporting</span> <span class="kn">import</span> <span class="n">plot_contrast_matrix</span>
<span class="n">plot_contrast_matrix</span><span class="p">(</span><span class="s1">&#39;StopSuccess - Go&#39;</span><span class="p">,</span> <span class="n">design_matrix</span><span class="p">)</span>
<a href="http://nilearn.github.io/modules/generated/nilearn.plotting.plot_glass_brain.html#nilearn.plotting.plot_glass_brain" title="View documentation for nilearn.plotting.plot_glass_brain"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_glass_brain</span></a><span class="p">(</span><span class="n">z_map</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">norm</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="mf">0.001</span><span class="p">),</span>
                          <span class="n">plot_abs</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span>
                          <span class="n">figure</span><span class="o">=</span><a href="http://matplotlib.org/api/_as_gen/matplotlib.figure.AxesStack.html#matplotlib.figure" title="View documentation for matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<a href="http://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="View documentation for matplotlib.pyplot.show"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><a class="first reference internal image-reference" href="../../_images/sphx_glr_plot_bids_features_004.png"><img alt="../../_images/sphx_glr_plot_bids_features_004.png" src="../../_images/sphx_glr_plot_bids_features_004.png" style="width: 376.0px; height: 188.0px;" /></a>
</li>
<li><a class="first reference internal image-reference" href="../../_images/sphx_glr_plot_bids_features_005.png"><img alt="../../_images/sphx_glr_plot_bids_features_005.png" src="../../_images/sphx_glr_plot_bids_features_005.png" style="width: 188.0px; height: 188.0px;" /></a>
</li>
</ul>
<p>We can get a latex table from a Pandas Dataframe for display and publication</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nistats.reporting</span> <span class="kn">import</span> <span class="n">get_clusters_table</span>
<span class="k">print</span><span class="p">(</span><span class="n">get_clusters_table</span><span class="p">(</span><span class="n">z_map</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="mf">0.001</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">to_latex</span><span class="p">())</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">begin</span><span class="p">{</span><span class="n">tabular</span><span class="p">}{</span><span class="n">llrrrrl</span><span class="p">}</span>
\<span class="n">toprule</span>
<span class="p">{}</span> <span class="o">&amp;</span> <span class="n">Cluster</span> <span class="n">ID</span> <span class="o">&amp;</span>     <span class="n">X</span> <span class="o">&amp;</span>     <span class="n">Y</span> <span class="o">&amp;</span>     <span class="n">Z</span> <span class="o">&amp;</span>  <span class="n">Peak</span> <span class="n">Stat</span> <span class="o">&amp;</span> <span class="n">Cluster</span> <span class="n">Size</span> <span class="p">(</span><span class="n">mm3</span><span class="p">)</span> \\
\<span class="n">midrule</span>
<span class="mi">0</span>  <span class="o">&amp;</span>          <span class="mi">1</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">66.0</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">45.0</span> <span class="o">&amp;</span>  <span class="mf">22.0</span> <span class="o">&amp;</span>   <span class="mf">5.307532</span> <span class="o">&amp;</span>               <span class="mi">6300</span> \\
<span class="mi">1</span>  <span class="o">&amp;</span>         <span class="mi">1</span><span class="n">a</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">66.0</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">33.0</span> <span class="o">&amp;</span>  <span class="mf">18.0</span> <span class="o">&amp;</span>   <span class="mf">4.668929</span> <span class="o">&amp;</span>                    \\
<span class="mi">2</span>  <span class="o">&amp;</span>         <span class="mi">1</span><span class="n">b</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">48.0</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">36.0</span> <span class="o">&amp;</span>  <span class="mf">14.0</span> <span class="o">&amp;</span>   <span class="mf">4.534376</span> <span class="o">&amp;</span>                    \\
<span class="mi">3</span>  <span class="o">&amp;</span>         <span class="mi">1</span><span class="n">c</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">57.0</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">48.0</span> <span class="o">&amp;</span>  <span class="mf">10.0</span> <span class="o">&amp;</span>   <span class="mf">4.284222</span> <span class="o">&amp;</span>                    \\
<span class="mi">4</span>  <span class="o">&amp;</span>          <span class="mi">2</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">42.0</span> <span class="o">&amp;</span>  <span class="mf">15.0</span> <span class="o">&amp;</span>  <span class="mf">26.0</span> <span class="o">&amp;</span>   <span class="mf">4.918703</span> <span class="o">&amp;</span>               <span class="mi">2520</span> \\
<span class="mi">5</span>  <span class="o">&amp;</span>         <span class="mi">2</span><span class="n">a</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">51.0</span> <span class="o">&amp;</span>   <span class="mf">9.0</span> <span class="o">&amp;</span>  <span class="mf">34.0</span> <span class="o">&amp;</span>   <span class="mf">4.715845</span> <span class="o">&amp;</span>                    \\
<span class="mi">6</span>  <span class="o">&amp;</span>         <span class="mi">2</span><span class="n">b</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">42.0</span> <span class="o">&amp;</span>   <span class="mf">9.0</span> <span class="o">&amp;</span>  <span class="mf">30.0</span> <span class="o">&amp;</span>   <span class="mf">4.707434</span> <span class="o">&amp;</span>                    \\
<span class="mi">7</span>  <span class="o">&amp;</span>         <span class="mi">2</span><span class="n">c</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">57.0</span> <span class="o">&amp;</span>  <span class="mf">12.0</span> <span class="o">&amp;</span>  <span class="mf">38.0</span> <span class="o">&amp;</span>   <span class="mf">4.587956</span> <span class="o">&amp;</span>                    \\
<span class="mi">8</span>  <span class="o">&amp;</span>          <span class="mi">3</span> <span class="o">&amp;</span>  <span class="mf">57.0</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">27.0</span> <span class="o">&amp;</span>   <span class="mf">2.0</span> <span class="o">&amp;</span>   <span class="mf">4.692869</span> <span class="o">&amp;</span>                <span class="mi">504</span> \\
<span class="mi">9</span>  <span class="o">&amp;</span>         <span class="mi">3</span><span class="n">a</span> <span class="o">&amp;</span>  <span class="mf">66.0</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">27.0</span> <span class="o">&amp;</span>   <span class="mf">2.0</span> <span class="o">&amp;</span>   <span class="mf">3.664250</span> <span class="o">&amp;</span>                    \\
<span class="mi">10</span> <span class="o">&amp;</span>          <span class="mi">4</span> <span class="o">&amp;</span>  <span class="mf">42.0</span> <span class="o">&amp;</span>   <span class="mf">9.0</span> <span class="o">&amp;</span>  <span class="mf">34.0</span> <span class="o">&amp;</span>   <span class="mf">4.461193</span> <span class="o">&amp;</span>                <span class="mi">540</span> \\
<span class="mi">11</span> <span class="o">&amp;</span>          <span class="mi">5</span> <span class="o">&amp;</span>   <span class="mf">6.0</span> <span class="o">&amp;</span>  <span class="mf">18.0</span> <span class="o">&amp;</span>  <span class="mf">34.0</span> <span class="o">&amp;</span>   <span class="mf">4.257986</span> <span class="o">&amp;</span>               <span class="mi">2520</span> \\
<span class="mi">12</span> <span class="o">&amp;</span>         <span class="mi">5</span><span class="n">a</span> <span class="o">&amp;</span>  <span class="o">-</span><span class="mf">3.0</span> <span class="o">&amp;</span>  <span class="mf">15.0</span> <span class="o">&amp;</span>  <span class="mf">46.0</span> <span class="o">&amp;</span>   <span class="mf">4.078390</span> <span class="o">&amp;</span>                    \\
<span class="mi">13</span> <span class="o">&amp;</span>         <span class="mi">5</span><span class="n">b</span> <span class="o">&amp;</span>   <span class="mf">0.0</span> <span class="o">&amp;</span>   <span class="mf">0.0</span> <span class="o">&amp;</span>  <span class="mf">38.0</span> <span class="o">&amp;</span>   <span class="mf">3.815609</span> <span class="o">&amp;</span>                    \\
<span class="mi">14</span> <span class="o">&amp;</span>         <span class="mi">5</span><span class="n">c</span> <span class="o">&amp;</span>   <span class="mf">3.0</span> <span class="o">&amp;</span>   <span class="mf">9.0</span> <span class="o">&amp;</span>  <span class="mf">50.0</span> <span class="o">&amp;</span>   <span class="mf">3.798387</span> <span class="o">&amp;</span>                    \\
<span class="mi">15</span> <span class="o">&amp;</span>          <span class="mi">6</span> <span class="o">&amp;</span>   <span class="mf">6.0</span> <span class="o">&amp;</span>   <span class="mf">6.0</span> <span class="o">&amp;</span>  <span class="mf">54.0</span> <span class="o">&amp;</span>   <span class="mf">4.208105</span> <span class="o">&amp;</span>                <span class="mi">468</span> \\
<span class="mi">16</span> <span class="o">&amp;</span>         <span class="mi">6</span><span class="n">a</span> <span class="o">&amp;</span>   <span class="mf">6.0</span> <span class="o">&amp;</span>   <span class="mf">3.0</span> <span class="o">&amp;</span>  <span class="mf">62.0</span> <span class="o">&amp;</span>   <span class="mf">3.348351</span> <span class="o">&amp;</span>                    \\
<span class="mi">17</span> <span class="o">&amp;</span>          <span class="mi">7</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">45.0</span> <span class="o">&amp;</span>  <span class="mf">21.0</span> <span class="o">&amp;</span>   <span class="mf">2.0</span> <span class="o">&amp;</span>   <span class="mf">4.190472</span> <span class="o">&amp;</span>                <span class="mi">504</span> \\
<span class="mi">18</span> <span class="o">&amp;</span>         <span class="mi">7</span><span class="n">a</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">54.0</span> <span class="o">&amp;</span>  <span class="mf">21.0</span> <span class="o">&amp;</span>   <span class="mf">6.0</span> <span class="o">&amp;</span>   <span class="mf">3.385929</span> <span class="o">&amp;</span>                    \\
<span class="mi">19</span> <span class="o">&amp;</span>          <span class="mi">8</span> <span class="o">&amp;</span>  <span class="mf">45.0</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">21.0</span> <span class="o">&amp;</span>  <span class="mf">42.0</span> <span class="o">&amp;</span>   <span class="mf">4.163956</span> <span class="o">&amp;</span>                <span class="mi">432</span> \\
<span class="mi">20</span> <span class="o">&amp;</span>          <span class="mi">9</span> <span class="o">&amp;</span>  <span class="mf">63.0</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">24.0</span> <span class="o">&amp;</span>  <span class="mf">30.0</span> <span class="o">&amp;</span>   <span class="mf">4.079389</span> <span class="o">&amp;</span>                <span class="mi">360</span> \\
<span class="mi">21</span> <span class="o">&amp;</span>         <span class="mi">10</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">12.0</span> <span class="o">&amp;</span>   <span class="mf">6.0</span> <span class="o">&amp;</span>   <span class="mf">6.0</span> <span class="o">&amp;</span>   <span class="mf">4.056165</span> <span class="o">&amp;</span>                <span class="mi">792</span> \\
<span class="mi">22</span> <span class="o">&amp;</span>        <span class="mi">10</span><span class="n">a</span> <span class="o">&amp;</span>  <span class="o">-</span><span class="mf">9.0</span> <span class="o">&amp;</span>  <span class="o">-</span><span class="mf">3.0</span> <span class="o">&amp;</span>  <span class="mf">10.0</span> <span class="o">&amp;</span>   <span class="mf">3.726486</span> <span class="o">&amp;</span>                    \\
<span class="mi">23</span> <span class="o">&amp;</span>        <span class="mi">10</span><span class="n">b</span> <span class="o">&amp;</span>  <span class="o">-</span><span class="mf">9.0</span> <span class="o">&amp;</span>   <span class="mf">6.0</span> <span class="o">&amp;</span>  <span class="mf">14.0</span> <span class="o">&amp;</span>   <span class="mf">3.710553</span> <span class="o">&amp;</span>                    \\
<span class="mi">24</span> <span class="o">&amp;</span>         <span class="mi">11</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">27.0</span> <span class="o">&amp;</span>  <span class="mf">45.0</span> <span class="o">&amp;</span>  <span class="mf">18.0</span> <span class="o">&amp;</span>   <span class="mf">4.043724</span> <span class="o">&amp;</span>                <span class="mi">432</span> \\
<span class="mi">25</span> <span class="o">&amp;</span>         <span class="mi">12</span> <span class="o">&amp;</span>  <span class="mf">12.0</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">72.0</span> <span class="o">&amp;</span>  <span class="mf">22.0</span> <span class="o">&amp;</span>   <span class="mf">3.965342</span> <span class="o">&amp;</span>                <span class="mi">360</span> \\
<span class="mi">26</span> <span class="o">&amp;</span>         <span class="mi">13</span> <span class="o">&amp;</span>   <span class="mf">3.0</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">24.0</span> <span class="o">&amp;</span>  <span class="mf">30.0</span> <span class="o">&amp;</span>   <span class="mf">3.950054</span> <span class="o">&amp;</span>                <span class="mi">360</span> \\
<span class="mi">27</span> <span class="o">&amp;</span>         <span class="mi">14</span> <span class="o">&amp;</span>  <span class="mf">33.0</span> <span class="o">&amp;</span>  <span class="mf">42.0</span> <span class="o">&amp;</span>  <span class="mf">34.0</span> <span class="o">&amp;</span>   <span class="mf">3.906274</span> <span class="o">&amp;</span>                <span class="mi">756</span> \\
<span class="mi">28</span> <span class="o">&amp;</span>        <span class="mi">14</span><span class="n">a</span> <span class="o">&amp;</span>  <span class="mf">30.0</span> <span class="o">&amp;</span>  <span class="mf">45.0</span> <span class="o">&amp;</span>  <span class="mf">26.0</span> <span class="o">&amp;</span>   <span class="mf">3.882906</span> <span class="o">&amp;</span>                    \\
<span class="mi">29</span> <span class="o">&amp;</span>         <span class="mi">15</span> <span class="o">&amp;</span>  <span class="mf">51.0</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mf">30.0</span> <span class="o">&amp;</span>  <span class="mf">14.0</span> <span class="o">&amp;</span>   <span class="mf">3.807061</span> <span class="o">&amp;</span>                <span class="mi">684</span> \\
\<span class="n">bottomrule</span>
\<span class="n">end</span><span class="p">{</span><span class="n">tabular</span><span class="p">}</span>
</pre></div>
</div>
<p><strong>Total running time of the script:</strong> ( 0 minutes  17.067 seconds)</p>
<div class="sphx-glr-footer docutils container">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../../_downloads/plot_bids_features.py" download=""><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_bids_features.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../../_downloads/plot_bids_features.ipynb" download=""><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_bids_features.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Generated by Sphinx-Gallery</a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="plot_spm_auditory.html" title="3.1.3. Univariate analysis of block design, one condition versus rest, single subject"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_bids_analysis.html" title="3.1.1. BIDS dataset first and second level analysis"
             >previous</a> |</li>
<li><a href="../../index.html">Nistats Home</a> |&nbsp;</li>
<li><a href="../../user_guide.html">User Guide</a> |&nbsp;</li>
<li><a href="../index.html">Examples</a> |&nbsp;</li>
<li><a href="../../modules/reference.html">Reference</a> |&nbsp;</li>
<li id="navbar-about"><a href="../../authors.html">About</a>|&nbsp;</li>
<li id="navbar-ecosystem"><a href="http://www.nipy.org/">Nipy ecosystem</a></li>

          <li class="nav-item nav-item-1"><a href="../../user_guide.html" >User guide: table of contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >3. Nistats usage examples</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer">
            &copy; The nistats developers 2010-2016.
          Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.7.7.
        <span style="padding-left: 5ex;">
          <a href="../../_sources/auto_examples/01_tutorials/plot_bids_features.rst.txt"
        	 rel="nofollow">Show this page source</a>
        </span>
    </div>
  </body>
</html>