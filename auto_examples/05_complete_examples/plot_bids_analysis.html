
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Nistats: Functional MRI in Python &#8212; functional MRI for NeuroImaging</title>
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.5.2. Surface-based dataset first and second level analysis of a dataset" href="plot_surface_bids_analysis.html" />
    <link rel="prev" title="2.4.4. Examples of design matrices" href="../04_low_level_functions/plot_design_matrix.html" />
<meta content="True" name="HandheldFriendly">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<meta name="keywords" content="nistats, neuroimaging, python, neuroscience, statistics">
<script type="text/javascript">
$(function () {
    // Lock the table of content to a fixed position once we scroll enough
    var top = 105 + $('.sphinxsidebarwrapper').offset().top - parseFloat($('.sphinxsidebarwrapper').css('margin-top').replace(/auto/, 0)),
        sections = {},
        i        = 0,
	url	 = document.URL.replace(/#.*$/, ""),
	current_section = 0;

    // Grab positions of our sections
    $('.headerlink').each(function(){
        sections[this.href.replace(url, '')] = $(this).offset().top - 50;
    });

    $(window).scroll(function(event) {
	var pos   = $(window).scrollTop();
	// Lock the table of content to a fixed position once we scroll enough
	if(pos > top){
	    //begin to scroll
	    $('.sphinxsidebarwrapper').css("position", "fixed");
	    $('.sphinxsidebarwrapper').css("top", -105);
	}
	else{
	    //lock it back into place
	    $('.sphinxsidebarwrapper').css("position", "relative");
	    $('.sphinxsidebarwrapper').css("top",0);
	}

	// Highlight the current section
	$('a.internal').removeClass('active');
        for(i in sections){
            if(sections[i] > pos){
		break;
            };
	    if($('a.internal[href$="' + i + '"]').is(':visible')){
		current_section = i;
	    };
        }
	$('a.internal[href$="' + current_section + '"]').addClass('active');
    });

});
</script>


<script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-41920728-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

  </head><body>
<div id="logo-banner">
  <div class="logo">
    <a href="../../index.html">
      <img src="../../_static/nistats-logo.png" alt="Nistats logo"  border="0" />
    </a>
  </div>
  <!-- A tag cloud to make it easy for people to find what they are
                         looking for -->
 <div class="tags">
  <ul>
    <li>
      <big><a href="../04_low_level_functions/plot_hrf.html">HRF</a></big>
    </li>
    <li>
      <small><a href="../04_low_level_functions/plot_design_matrix.html">Design Matrix</a></small>
    </li>
    <li>
      <small><a href="../02_first_level_models/plot_localizer_analysis.html">First Level</a></small>
    </li>
    <li>
      <big><a href="../03_second_level_models/plot_thresholding.html">Second Level</a></big>
    </li>
    <li>
      <big><a href="../01_tutorials/plot_bids_analysis.html">BIDS datasets</a></big>
    </li>
  </ul>
 </div>

  <div class="banner">
    <h1>Nistats:</h1>
    <h2>Functional MRI Neuro-Imaging in Python</h2>
  </div>
  <div class="search_form">
    <div id="cse" style="width: 100%;"></div>
    <script src="http://www.google.com/jsapi" type="text/javascript"></script>
    <script type="text/javascript">
      google.load('search', '1', {language : 'en'});
      google.setOnLoadCallback(function() {
      var customSearchControl = new google.search.CustomSearchControl('014136483057745874622:r-npolb1uki');
      customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
      var options = new google.search.DrawOptions();
      options.setAutoComplete(true);
      customSearchControl.draw('cse', options);
      }, true);
    </script>
  </div>
</div>



    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="plot_surface_bids_analysis.html" title="2.5.2. Surface-based dataset first and second level analysis of a dataset"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../04_low_level_functions/plot_design_matrix.html" title="2.4.4. Examples of design matrices"
             accesskey="P">previous</a> |</li>
<li><a href="../../index.html">Nistats Home</a> |&nbsp;</li>
<li><a href="../../user_guide.html">User Guide</a> |&nbsp;</li>
<li><a href="../index.html">Examples</a> |&nbsp;</li>
<li><a href="../../modules/reference.html">Reference</a> |&nbsp;</li>
<li id="navbar-about"><a href="../../authors.html">About</a>|&nbsp;</li>
<li id="navbar-ecosystem"><a href="http://www.nipy.org/">Nipy ecosystem</a></li>

          <li class="nav-item nav-item-1"><a href="../../user_guide.html" >User guide: table of contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" accesskey="U">2. Nistats usage examples</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">


<h4> Giving credit </h4>
  <ul class="simple">
    <li><p>Please consider <a href="../../authors.html#citing">citing the
                    papers</a>.</p></li>
  </ul>

  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">2.5.1. BIDS dataset first and second level analysis</a><ul>
<li><a class="reference internal" href="#fetch-example-bids-dataset">2.5.1.1. Fetch example BIDS dataset</a></li>
<li><a class="reference internal" href="#obtain-automatically-firstlevelmodel-objects-and-fit-arguments">2.5.1.2. Obtain automatically FirstLevelModel objects and fit arguments</a></li>
<li><a class="reference internal" href="#quick-sanity-check-on-fit-arguments">2.5.1.3. Quick sanity check on fit arguments</a></li>
<li><a class="reference internal" href="#first-level-model-estimation">2.5.1.4. First level model estimation</a></li>
<li><a class="reference internal" href="#second-level-model-estimation">2.5.1.5. Second level model estimation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../04_low_level_functions/plot_design_matrix.html"
                        title="previous chapter">2.4.4. Examples of design matrices</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="plot_surface_bids_analysis.html"
                        title="next chapter">2.5.2. Surface-based dataset first and second level analysis of a dataset</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-05-complete-examples-plot-bids-analysis-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="bids-dataset-first-and-second-level-analysis">
<span id="sphx-glr-auto-examples-05-complete-examples-plot-bids-analysis-py"></span><h1>2.5.1. BIDS dataset first and second level analysis<a class="headerlink" href="#bids-dataset-first-and-second-level-analysis" title="Permalink to this headline">Â¶</a></h1>
<p>Full step-by-step example of fitting a GLM to perform a first and second level
analysis in a BIDS dataset and visualizing the results. Details about the BIDS
standard can be consulted at <a class="reference external" href="http://bids.neuroimaging.io/">http://bids.neuroimaging.io/</a></p>
<p>More specifically:</p>
<ol class="arabic simple">
<li><p>Download an fMRI BIDS dataset with two language conditions to contrast.</p></li>
<li><p>Extract automatically from the BIDS dataset first level model objects</p></li>
<li><p>Fit a second level model on the fitted first level models. Notice that
in this case the preprocessed bold images were already normalized to the
same MNI space.</p></li>
</ol>
<p>To run this example, you must launch IPython via <code class="docutils literal notranslate"><span class="pre">ipython</span>
<span class="pre">--matplotlib</span></code> in a terminal, or use the Jupyter notebook.</p>
<div class="contents local topic" id="contents">
<p class="topic-title first"><strong>Contents</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#fetch-example-bids-dataset" id="id1">Fetch example BIDS dataset</a></p></li>
<li><p><a class="reference internal" href="#obtain-automatically-firstlevelmodel-objects-and-fit-arguments" id="id2">Obtain automatically FirstLevelModel objects and fit arguments</a></p></li>
<li><p><a class="reference internal" href="#quick-sanity-check-on-fit-arguments" id="id3">Quick sanity check on fit arguments</a></p></li>
<li><p><a class="reference internal" href="#first-level-model-estimation" id="id4">First level model estimation</a></p></li>
<li><p><a class="reference internal" href="#second-level-model-estimation" id="id5">Second level model estimation</a></p></li>
</ul>
</div>
<div class="section" id="fetch-example-bids-dataset">
<h2><a class="toc-backref" href="#id1">2.5.1.1. Fetch example BIDS dataset</a><a class="headerlink" href="#fetch-example-bids-dataset" title="Permalink to this headline">Â¶</a></h2>
<p>We download an simplified BIDS dataset made available for illustrative
purposes. It contains only the necessary
information to run a statistical analysis using Nistats. The raw data
subject folders only contain bold.json and events.tsv files, while the
derivatives folder with preprocessed files contain preproc.nii and
confounds.tsv files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nistats.datasets</span> <span class="k">import</span> <a href="../../modules/generated/nistats.datasets.fetch_language_localizer_demo_dataset.html#nistats.datasets.fetch_language_localizer_demo_dataset" title="View documentation for nistats.datasets.fetch_language_localizer_demo_dataset"><span class="n">fetch_language_localizer_demo_dataset</span></a>
<span class="n">data_dir</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <a href="../../modules/generated/nistats.datasets.fetch_language_localizer_demo_dataset.html#nistats.datasets.fetch_language_localizer_demo_dataset" title="View documentation for nistats.datasets.fetch_language_localizer_demo_dataset"><span class="n">fetch_language_localizer_demo_dataset</span></a><span class="p">()</span>
</pre></div>
</div>
<p>Here is the location of the dataset on disk</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/kshitij/nilearn_data/fMRI-language-localizer-demo-dataset
</pre></div>
</div>
</div>
<div class="section" id="obtain-automatically-firstlevelmodel-objects-and-fit-arguments">
<h2><a class="toc-backref" href="#id2">2.5.1.2. Obtain automatically FirstLevelModel objects and fit arguments</a><a class="headerlink" href="#obtain-automatically-firstlevelmodel-objects-and-fit-arguments" title="Permalink to this headline">Â¶</a></h2>
<p>From the dataset directory we obtain automatically FirstLevelModel objects
with their subject_id filled from the BIDS dataset. Moreover we obtain
for each model a dictionary with run_imgs, events and confounder regressors
since in this case a confounds.tsv file is available in the BIDS dataset.
To get the first level models we only have to specify the dataset directory
and the task_label as specified in the file names.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nistats.first_level_model</span> <span class="k">import</span> <a href="../../modules/generated/nistats.first_level_model.first_level_models_from_bids.html#nistats.first_level_model.first_level_models_from_bids" title="View documentation for nistats.first_level_model.first_level_models_from_bids"><span class="n">first_level_models_from_bids</span></a>
<span class="n">task_label</span> <span class="o">=</span> <span class="s1">&#39;languagelocalizer&#39;</span>
<span class="n">models</span><span class="p">,</span> <span class="n">models_run_imgs</span><span class="p">,</span> <span class="n">models_events</span><span class="p">,</span> <span class="n">models_confounds</span> <span class="o">=</span> \
    <a href="../../modules/generated/nistats.first_level_model.first_level_models_from_bids.html#nistats.first_level_model.first_level_models_from_bids" title="View documentation for nistats.first_level_model.first_level_models_from_bids"><span class="n">first_level_models_from_bids</span></a><span class="p">(</span>
        <span class="n">data_dir</span><span class="p">,</span> <span class="n">task_label</span><span class="p">,</span>
        <span class="n">img_filters</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;desc&#39;</span><span class="p">,</span> <span class="s1">&#39;preproc&#39;</span><span class="p">)])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/kshitij/workspace/nistats-org/nistats-repo/kchawla-pi/nistats/nistats/first_level_model.py:703: ResourceWarning: unclosed file &lt;_io.TextIOWrapper name=&#39;/home/kshitij/nilearn_data/fMRI-language-localizer-demo-dataset/derivatives/sub-01/func/sub-01_task-languagelocalizer_desc-preproc_bold.json&#39; mode=&#39;r&#39; encoding=&#39;UTF-8&#39;&gt;
  specs = json.load(open(img_specs[0], &#39;r&#39;))
/home/kshitij/workspace/nistats-org/nistats-repo/kchawla-pi/nistats/nistats/first_level_model.py:718: UserWarning: SliceTimingRef not found in file /home/kshitij/nilearn_data/fMRI-language-localizer-demo-dataset/derivatives/sub-01/func/sub-01_task-languagelocalizer_desc-preproc_bold.json. It will be assumed that the slice timing reference is 0.0 percent of the repetition time. If it is not the case it will need to be set manually in the generated list of models
  img_specs[0])
</pre></div>
</div>
</div>
<div class="section" id="quick-sanity-check-on-fit-arguments">
<h2><a class="toc-backref" href="#id3">2.5.1.3. Quick sanity check on fit arguments</a><a class="headerlink" href="#quick-sanity-check-on-fit-arguments" title="Permalink to this headline">Â¶</a></h2>
<p>Additional checks or information extraction from pre-processed data can
be made here</p>
<p>We just expect one run img per subject.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="nb">print</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">run</span><span class="p">)</span> <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">models_run_imgs</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[&#39;sub-01_task-languagelocalizer_desc-preproc_bold.nii.gz&#39;]
</pre></div>
</div>
<p>The only confounds stored are regressors obtained from motion correction. As
we can verify from the column headers of the confounds table corresponding
to the only run_img present</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">models_confounds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Index([&#39;RotX&#39;, &#39;RotY&#39;, &#39;RotZ&#39;, &#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
<p>During this acquisition the subject read blocks of sentences and
consonant strings. So these are our only two conditions in events.
We verify there are 12 blocks for each condition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">models_events</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;trial_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>language    12
string      12
Name: trial_type, dtype: int64
</pre></div>
</div>
</div>
<div class="section" id="first-level-model-estimation">
<h2><a class="toc-backref" href="#id4">2.5.1.4. First level model estimation</a><a class="headerlink" href="#first-level-model-estimation" title="Permalink to this headline">Â¶</a></h2>
<p>Now we simply fit each first level model and plot for each subject the
contrast that reveals the language network (language - string). Notice that
we can define a contrast using the names of the conditions specified in the
events dataframe. Sum, substraction and scalar multiplication are allowed.</p>
<p>Set the threshold as the z-variate with an uncorrected p-value of 0.001</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="k">import</span> <span class="n">norm</span>
<span class="n">p001_unc</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
</pre></div>
</div>
<p>Prepare figure for concurrent plot of individual maps</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn</span> <span class="k">import</span> <span class="n">plotting</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="View documentation for matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
<span class="n">model_and_args</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">models_run_imgs</span><span class="p">,</span> <span class="n">models_events</span><span class="p">,</span> <span class="n">models_confounds</span><span class="p">)</span>
<span class="k">for</span> <span class="n">midx</span><span class="p">,</span> <span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">imgs</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">confounds</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">model_and_args</span><span class="p">):</span>
    <span class="c1"># fit the GLM</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">imgs</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">confounds</span><span class="p">)</span>
    <span class="c1"># compute the contrast of interest</span>
    <span class="n">zmap</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="s1">&#39;language-string&#39;</span><span class="p">)</span>
    <a href="http://nilearn.github.io/modules/generated/nilearn.plotting.plot_glass_brain.html#nilearn.plotting.plot_glass_brain" title="View documentation for nilearn.plotting.plot_glass_brain"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_glass_brain</span></a><span class="p">(</span><span class="n">zmap</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">p001_unc</span><span class="p">,</span>
                              <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;sub-&#39;</span> <span class="o">+</span> <span class="n">model</span><span class="o">.</span><span class="n">subject_label</span><span class="p">),</span>
                              <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">midx</span> <span class="o">/</span> <span class="mi">5</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">midx</span> <span class="o">%</span> <span class="mi">5</span><span class="p">)],</span>
                              <span class="n">plot_abs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;subjects z_map language network (unc p&lt;0.001)&#39;</span><span class="p">)</span>
<a href="http://nilearn.github.io/modules/generated/nilearn.plotting.show.html#nilearn.plotting.show" title="View documentation for nilearn.plotting.show"><span class="n">plotting</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_bids_analysis_001.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_bids_analysis_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/kshitij/.programs/anaconda3/envs/nistats-py36-latest/lib/python3.6/site-packages/nilearn/_utils/cache_mixin.py:232: DeprecationWarning: The &#39;cachedir&#39; attribute has been deprecated in version 0.12 and will be removed in version 0.14.
Use os.path.join(memory.location, &#39;joblib&#39;) attribute instead.
  if (memory.cachedir is None and memory_level is not None
/home/kshitij/.programs/anaconda3/envs/nistats-py36-latest/lib/python3.6/site-packages/scipy/ndimage/measurements.py:272: DeprecationWarning: In future, it will be an error for &#39;np.bool_&#39; scalars to be interpreted as an index
  return _nd_image.find_objects(input, max_label)
</pre></div>
</div>
</div>
<div class="section" id="second-level-model-estimation">
<h2><a class="toc-backref" href="#id5">2.5.1.5. Second level model estimation</a><a class="headerlink" href="#second-level-model-estimation" title="Permalink to this headline">Â¶</a></h2>
<p>We just have to provide the list of fitted FirstLevelModel objects
to the SecondLevelModel object for estimation. We can do this because
all subjects share a similar design matrix (same variables reflected in
column names)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nistats.second_level_model</span> <span class="k">import</span> <a href="../../modules/generated/nistats.second_level_model.SecondLevelModel.html#nistats.second_level_model.SecondLevelModel" title="View documentation for nistats.second_level_model.SecondLevelModel"><span class="n">SecondLevelModel</span></a>
<span class="n">second_level_input</span> <span class="o">=</span> <span class="n">models</span>
</pre></div>
</div>
<p>Note that we apply a smoothing of 8mm.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">second_level_model</span> <span class="o">=</span> <a href="../../modules/generated/nistats.second_level_model.SecondLevelModel.html#nistats.second_level_model.SecondLevelModel" title="View documentation for nistats.second_level_model.SecondLevelModel"><span class="n">SecondLevelModel</span></a><span class="p">(</span><span class="n">smoothing_fwhm</span><span class="o">=</span><span class="mf">8.0</span><span class="p">)</span>
<span class="n">second_level_model</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">second_level_input</span><span class="p">)</span>
</pre></div>
</div>
<p>Computing contrasts at the second level is as simple as at the first level
Since we are not providing confounders we are performing an one-sample test
at the second level with the images determined by the specified first level
contrast.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">zmap</span> <span class="o">=</span> <span class="n">second_level_model</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span>
    <span class="n">first_level_contrast</span><span class="o">=</span><span class="s1">&#39;language-string&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The group level contrast reveals a left lateralized fronto-temporal
language network</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="http://nilearn.github.io/modules/generated/nilearn.plotting.plot_glass_brain.html#nilearn.plotting.plot_glass_brain" title="View documentation for nilearn.plotting.plot_glass_brain"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_glass_brain</span></a><span class="p">(</span><span class="n">zmap</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">p001_unc</span><span class="p">,</span>
                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Group language network (unc p&lt;0.001)&#39;</span><span class="p">,</span>
                          <span class="n">plot_abs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<a href="http://nilearn.github.io/modules/generated/nilearn.plotting.show.html#nilearn.plotting.show" title="View documentation for nilearn.plotting.show"><span class="n">plotting</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_bids_analysis_002.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_bids_analysis_002.png" />
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  29.223 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-05-complete-examples-plot-bids-analysis-py">
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/0d6ac7c9ad8dc18a516b1a6ae1e684f2/plot_bids_analysis.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_bids_analysis.py</span></code></a></p>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/f0b4e8b4ac3d8c335c80db845282972a/plot_bids_analysis.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_bids_analysis.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="plot_surface_bids_analysis.html" title="2.5.2. Surface-based dataset first and second level analysis of a dataset"
             >next</a> |</li>
        <li class="right" >
          <a href="../04_low_level_functions/plot_design_matrix.html" title="2.4.4. Examples of design matrices"
             >previous</a> |</li>
<li><a href="../../index.html">Nistats Home</a> |&nbsp;</li>
<li><a href="../../user_guide.html">User Guide</a> |&nbsp;</li>
<li><a href="../index.html">Examples</a> |&nbsp;</li>
<li><a href="../../modules/reference.html">Reference</a> |&nbsp;</li>
<li id="navbar-about"><a href="../../authors.html">About</a>|&nbsp;</li>
<li id="navbar-ecosystem"><a href="http://www.nipy.org/">Nipy ecosystem</a></li>

          <li class="nav-item nav-item-1"><a href="../../user_guide.html" >User guide: table of contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >2. Nistats usage examples</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer">
            &copy; The nistats developers 2010-2016.
          Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.1.2.
        <span style="padding-left: 5ex;">
          <a href="../../_sources/auto_examples/05_complete_examples/plot_bids_analysis.rst.txt"
        	 rel="nofollow">Show this page source</a>
        </span>
    </div>
  </body>
</html>